<% current_user.applications.where(course: course).each do |application| %>
  <%= govuk_summary_card(title: "#{title_embedded_course_name(course)}") do |card| %>
    <% card.with_action { govuk_link_to("More details", accounts_user_registration_path(application)) } %>
    <dl class="govuk-summary-list">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Registration submitted
        </dt>
        <dd class="govuk-summary-list__value">
          <%= application.created_at.to_date.to_s(:govuk_short) %>
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Provider
        </dt>
        <dd class="govuk-summary-list__value">
          <%= application.lead_provider.name %>
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Provider application
        </dt>
        <dd class="govuk-summary-list__value">
            <% if application.lead_provider_approval_status.blank? || application.lead_provider_approval_status.capitalize == "Pending" %>
              <strong class="govuk-tag govuk-tag--yellow">APPLY WITH PROVIDER</strong>
              <p class="govuk-!-margin-top-2 govuk-!-margin-bottom-0"><%= I18n.t("provider_details.pending_status")  %></p>
            <% elsif application.lead_provider_approval_status.capitalize == "Accepted" %>
              <strong class="govuk-tag govuk-tag--green">SUCCESSFUL</strong>
            <% elsif application.lead_provider_approval_status.capitalize == "Rejected" %>
              <strong class="govuk-tag govuk-tag--red">UNSUCCESSFUL</strong>
            <% end %>
        </dd>
      </div>

      <% if application.participant_outcome_state.present? && application.lead_provider_approval_status.capitalize == "Accepted" %>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            Course status
          </dt>
          <dd class="govuk-summary-list__value">
              <% if application.participant_outcome_state.capitalize == "Passed" %>
                <strong class="govuk-tag govuk-tag--green">PASSED</strong>
              <% elsif application.participant_outcome_state.capitalize == "Failed" %>
                <strong class="govuk-tag govuk-tag--red">NOT PASSED</strong>
              <% end %>
          </dd>
        </div>
      <% end %>
    </dl>
  <% end %>
<% end %>
